# VisionFlow | 이미지-엑셀 변환 서비스 🖼️➡️📊

VisionFlow는 최신 컴퓨터 비전 기술(OpenCV)을 활용하여 이미지 내의 복잡한 표 데이터를 정밀하게 인식하고, 색상 기반의 데이터를 분석하여 엑셀 파일로 변환해주는 지능형 웹 애플리케이션입니다.

## ✨ 주요 기능

- **정밀 그리드 감지 (Smart Grid Detection)**:
  - 이미지 내 표의 격자선을 자동으로 검출하고 손상된 라인을 복구합니다.
  - 데이터의 밀도와 간격을 분석하여 헤더와 범례를 제외한 순수 데이터 영역만 정확히 추출합니다.
- **색상 기반 데이터 분석**:
  - 표 안의 색상 점(🟢, 🟡, 🟣)을 인식하여 위치(층/호수)별 데이터를 매핑합니다.
  - 노이즈 제거 및 중복 데이터 방지 알고리즘 적용.
- **드래그 앤 드롭**: 직관적인 인터페이스로 파일을 쉽고 빠르게 업로드
- **실시간 데이터 확인**: 변환된 데이터를 테이블 형태로 즉시 미리보고 확인
- **프리미엄 엑셀 내보내기**: SheetJS를 사용하여 즉시 활용 가능한 `.xlsx` 파일 생성
- **모던 디자인**: 유리 질감(Glassmorphism)과 다크 모드가 적용된 고급스러운 UI

## 🚀 알고리즘 특징 (v2.0)

본 프로젝트는 단순 OCR을 넘어선 **하이브리드 그리드 분석 엔진**을 탑재하고 있습니다:

1. **데이터-라인 상호 보정**: 데이터 점들의 분포를 분석하여 그리드 라인의 간격을 역추적, 노이즈 라인을 제거하고 누락된 라인을 복원합니다.
2. **자동 범위 보정 (Auto Boundary Correction)**: 테이블 헤더나 범례 영역을 데이터로 오인하지 않도록, 데이터의 연속성과 분포를 기반으로 유효 테이블 범위를 자동으로 보정합니다.
3. **희소 데이터 처리**: 데이터가 드문드문 존재하는 경우에도 정확한 행/열 구조를 유지합니다.

## 🚀 시작하기

1. **의존성 설치**
   ```bash
   npm install
   pip install -r requirements.txt
   ```

2. **서버 실행 (터미널 2개 필요)**

   **터미널 1** — 백엔드 서버 (포트 3500):
   ```bash
   node server.js
   ```

   **터미널 2** — 프론트엔드 개발 서버 (포트 5173):
   ```bash
   npm run dev
   ```

   > ⚠️ 두 서버를 **동시에** 실행해야 합니다. `node server.js`가 꺼져 있으면 변환 시 "Failed to fetch" 오류가 발생합니다.

3. **브라우저 접속**
   - 기본 주소: `http://localhost:5173/`

## 🛠 기술 스택

- **Frontend**: Vite, Vanilla JavaScript
- **Styling**: Modern CSS (Flexbox, Grid, Glassmorphism)
- **Core Engine**: **Python 3, OpenCV, NumPy** (Grid & Color Detection)
- **Server**: Node.js (Express) - Python 스크립트 연동
- **Excel Library**: [SheetJS (xlsx)](https://sheetjs.com/)

## 📝 사용 방법

1. 변환하고자 하는 아파트/건물 점검표 이미지를 준비합니다.
2. 메인 화면의 업로드 영역에 이미지를 드래그하거나 클릭하여 선택합니다.
3. '변환 시작' 버튼을 누르고 잠시 기다립니다. (서버에서 정밀 분석 수행)
4. 인식된 결과(층/호수별 색상 데이터)를 확인한 후 '엑셀 다운로드'를 클릭하여 저장합니다.

---
© 2026 VisionFlow Team. Built with Antigravity.
