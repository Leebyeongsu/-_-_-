# VisionFlow 사무실 사용 가이드

> 이미지(아파트 현황표)를 엑셀 파일로 자동 변환하는 프로그램입니다.
> 컴퓨터에 익숙하지 않은 분도 따라할 수 있도록 단계별로 설명합니다.

---

## 목차

1. [사전 준비 (최초 1회)](#1-사전-준비-최초-1회)
2. [프로젝트 다운로드 (최초 1회)](#2-프로젝트-다운로드-최초-1회)
3. [프로그램 실행하기](#3-프로그램-실행하기)
4. [1단계: 이미지를 기본 엑셀로 변환하기](#4-1단계-이미지를-기본-엑셀로-변환하기)
5. [2단계: 기본 엑셀을 층호수 형태로 변환하기](#5-2단계-기본-엑셀을-층호수-형태로-변환하기)
6. [동료와 함께 사용하기](#6-동료와-함께-사용하기-같은-네트워크)
7. [자주 묻는 질문 (FAQ)](#7-자주-묻는-질문-faq)

---

## 전체 흐름 요약

```
[1단계]                              [2단계]
이미지 업로드 → OCR 분석 →           기본 엑셀 업로드 →
기본 엑셀 다운로드                    층호수 형태 변환 → 다운로드

(왼쪽+중간 카드)                     (오른쪽 카드)
```

### 최종 결과물 예시

```
층 | 01호        | 02호        | 03호        | ...
25 | 2501  KT    | 2502        | 2503  M     | ...
24 | 2401        | 2402  KT    | 2403        | ...
```

- **KT** = 빨간색 글자 (원본 녹색/핑크 셀)
- **M** = 녹색 글자 (원본 노란색 셀)
- 빈칸 = 해당 없음 (원본 흰색 셀)

---

## 1. 사전 준비 (최초 1회)

아래 2개 프로그램을 설치해야 합니다.

### 1-1. Node.js 설치

1. 브라우저에서 아래 주소 접속:
   ```
   https://nodejs.org
   ```
2. 초록색 **LTS** 버튼 클릭하여 다운로드
3. 다운로드된 파일 더블클릭 → **Next** 계속 클릭 → **Install** → **Finish**

#### 설치 확인
1. 키보드에서 `Win + R` 누르기
2. `cmd` 입력 후 Enter
3. 아래 명령어 입력:
   ```
   node --version
   ```
4. `v18.x.x` 또는 `v20.x.x` 같은 버전 번호가 나오면 성공!

---

### 1-2. Python 설치

1. 브라우저에서 아래 주소 접속:
   ```
   https://www.python.org/downloads/
   ```
2. 노란색 **Download Python 3.x.x** 버튼 클릭
3. 다운로드된 파일 더블클릭
4. **중요!** 맨 아래 **"Add Python to PATH"** 체크박스를 **반드시 체크!**
5. **Install Now** 클릭 → 설치 완료

#### 설치 확인
1. `Win + R` → `cmd` → Enter
2. 아래 명령어 입력:
   ```
   python --version
   ```
3. `Python 3.10.x` 이상 버전이 나오면 성공!

---

### 1-3. Git 설치 (선택사항)

프로젝트를 다운로드하는 데 필요합니다. ZIP으로 다운로드할 경우 생략 가능합니다.

1. 브라우저에서 접속:
   ```
   https://git-scm.com/downloads
   ```
2. **Windows** 선택 → 다운로드 → 설치 (기본 옵션으로 Next 클릭)

---

## 2. 프로젝트 다운로드 (최초 1회)

### 방법 A: Git으로 다운로드 (추천)

1. 바탕화면에서 마우스 우클릭 → **터미널에서 열기** (또는 **Git Bash Here**)
2. 아래 명령어를 한 줄씩 입력:

   ```bash
   git clone https://github.com/Leebyeongsu/-_-2.git
   ```
3. 바탕화면에 `-_-2` 폴더가 생성됩니다.

### 방법 B: ZIP으로 다운로드

1. 브라우저에서 접속:
   ```
   https://github.com/Leebyeongsu/-_-2
   ```
2. 초록색 **<> Code** 버튼 클릭
3. **Download ZIP** 클릭
4. 다운로드된 ZIP 파일을 바탕화면에 압축 해제

---

### 2-1. 패키지 설치 (최초 1회)

1. 다운로드된 프로젝트 폴더에 들어가기
2. 폴더 안의 빈 공간에서 **마우스 우클릭** → **터미널에서 열기**
3. 아래 명령어를 한 줄씩 입력 (각 줄 입력 후 Enter):

   ```bash
   npm install
   ```
   → (1~2분 소요) 완료 메시지가 나올 때까지 대기

   ```bash
   pip install -r requirements.txt
   ```
   → (3~5분 소요, 첫 설치 시 오래 걸립니다) 완료될 때까지 대기

4. 오류 없이 끝나면 설치 완료!

---

## 3. 프로그램 실행하기

> **터미널 창 2개**를 열어야 합니다. 둘 다 켜져 있어야 프로그램이 작동합니다.

### 터미널 1: 백엔드 서버

1. 프로젝트 폴더에서 마우스 우클릭 → **터미널에서 열기**
2. 아래 명령어 입력:
   ```bash
   node server.js
   ```
3. 아래와 같은 메시지가 나오면 성공:
   ```
   🚀 Server at http://localhost:3500
   📦 OCR Engine: v3 (자동 그리드 + EasyOCR)
   ```
4. **이 창을 닫지 마세요!** 최소화만 해두세요.

### 터미널 2: 프론트엔드 서버

1. **새 터미널 창**을 하나 더 엽니다 (프로젝트 폴더에서 다시 우클릭 → 터미널에서 열기)
2. 아래 명령어 입력:
   ```bash
   npm run dev
   ```
3. 아래와 같은 메시지가 나오면 성공:
   ```
   VITE ready in xxx ms
   ➜ Local: http://localhost:5173/
   ```
4. **이 창도 닫지 마세요!** 최소화만 해두세요.

### 브라우저에서 접속

1. 크롬(Chrome) 또는 엣지(Edge) 브라우저를 엽니다
2. 주소창에 아래 주소를 입력하고 Enter:
   ```
   http://localhost:5173
   ```
3. **VisionFlow** 화면이 나타나면 준비 완료!

---

## 4. 1단계: 이미지를 기본 엑셀로 변환하기

> 화면의 **왼쪽 카드**와 **중간 카드**를 사용합니다.

### 4-1. 이미지 업로드

1. 화면 왼쪽의 **"이미지 업로드"** 영역을 클릭합니다
2. 변환할 이미지 파일(아파트 현황표 캡처/사진)을 선택합니다
3. 이미지 미리보기가 나타납니다

### 4-2. 변환 실행

1. 중간 카드 하단의 **"변환 시작"** 버튼을 클릭합니다
2. "AI 분석 중..." 표시와 함께 잠시 대기합니다 (10~30초)
3. 변환이 완료되면 표 형태로 결과가 나타납니다

### 4-3. 기본 엑셀 다운로드

1. 화면에 표시된 결과(층/호수별 데이터)를 확인합니다
2. **"기본 엑셀 다운로드"** 버튼을 클릭합니다
3. `.xlsx` 파일이 **다운로드 폴더**에 저장됩니다
   - 예시 파일명: `LG신주례1차_106동_1770693222524.xlsx`

### 색상 의미

| 원본 색상 | 의미 |
|-----------|------|
| 노란색 | 모바일은 있으나 인터넷은 없는 고객 |
| 흰색 | KT상품을 이용하지 않는 고객 |
| 녹색 | Mega인터넷 또는 미동의인터넷 이용 고객 |
| 분홍색 | GiGA인터넷 이용 고객 |

---

## 5. 2단계: 기본 엑셀을 층호수 형태로 변환하기

> 화면의 **오른쪽 카드**를 사용합니다.
> 1단계에서 다운로드한 기본 엑셀 파일을 층호수 형태로 자동 변환합니다.

### 5-1. 엑셀 파일 업로드

1. 화면 오른쪽의 **"엑셀 파일 업로드"** 영역을 클릭합니다
2. **1단계에서 다운로드한 기본 엑셀 파일**을 선택합니다
   - 다운로드 폴더에서 방금 받은 파일을 찾으세요
   - 예시: `LG신주례1차_106동_1770693222524.xlsx`
3. 파일명과 크기가 표시됩니다

### 5-2. 층호수 형태로 변환

1. **"층호수 형태로 변환"** 버튼을 클릭합니다
2. 잠시 대기합니다 (1~3초)
3. 변환된 파일이 자동으로 다운로드됩니다
   - 예시 파일명: `LG신주례1차_106동_1770693222524_변환.xlsx`

### 5-3. 결과 확인

다운로드된 변환 파일을 Excel에서 열면 아래와 같은 형태입니다:

```
층 | 01호      |     | 02호      |     | 03호      |     | ...
25 | 2501      | KT  | 2502      |     | 2503      | M   | ...
24 | 2401      |     | 2402      | KT  | 2403      |     | ...
23 | 2301      |     | 2302      |     | 2303      |     | ...
```

#### 변환 규칙

| 원본 셀 색상 | 변환 결과 | 글자 색상 |
|-------------|----------|----------|
| 녹색, 분홍색 | KT | 빨간색 |
| 노란색 | M | 녹색 |
| 흰색 | (빈칸) | - |

#### 층호수 조합 방식

- **"25층" + "01호"** → **2501**
- **"14층" + "02호"** → **1402**
- **"3층" + "10호"** → **310**

---

## 6. 동료와 함께 사용하기 (같은 네트워크)

같은 사무실 Wi-Fi를 사용하는 동료들도 내 PC에 접속해서 사용할 수 있습니다.

### 6-1. 내 PC의 IP 주소 확인

1. `Win + R` → `cmd` → Enter
2. 아래 명령어 입력:
   ```
   ipconfig
   ```
3. **IPv4 주소** 항목을 찾습니다 (예: `192.168.0.15`)

### 6-2. 네트워크에 공개하여 실행

터미널 2에서 기존 명령어 대신 아래처럼 실행합니다:
```bash
npx vite --host 0.0.0.0
```

### 6-3. Windows 방화벽 허용

1. 시작 메뉴 → **"Windows 방화벽"** 검색 → **고급 보안이 포함된 Windows Defender 방화벽** 실행
2. 왼쪽 **"인바운드 규칙"** 클릭
3. 오른쪽 **"새 규칙"** 클릭
4. **포트** 선택 → 다음
5. **TCP** 선택 → 특정 로컬 포트에 `3500, 5173` 입력 → 다음
6. **연결 허용** → 다음 → 다음
7. 이름: `VisionFlow` 입력 → 마침

### 6-4. 동료 접속 방법

동료에게 아래 주소를 알려주세요:
```
http://192.168.0.15:5173
```
> `192.168.0.15` 부분은 본인의 IP 주소로 교체하세요.

---

## 7. 자주 묻는 질문 (FAQ)

### "변환 시작"을 누르면 "Failed to fetch" 오류가 나와요
→ **터미널 1** (`node server.js`)이 실행 중인지 확인하세요. 닫혔다면 다시 실행하세요.

### 브라우저 주소 `localhost:5173`에 접속이 안 돼요
→ **터미널 2** (`npm run dev`)가 실행 중인지 확인하세요. 닫혔다면 다시 실행하세요.

### 이미지 변환 결과가 정확하지 않아요
→ 이미지가 선명한지 확인하세요. 흐린 사진이나 너무 작은 이미지는 인식률이 떨어집니다.
→ 가능하면 **화면 캡처** 이미지를 사용하세요 (카메라 촬영보다 정확합니다).

### "python" 명령이 안 된다고 나와요
→ Python 설치 시 **"Add Python to PATH"** 를 체크하지 않은 경우입니다.
→ Python을 삭제 후 다시 설치하면서 해당 옵션을 꼭 체크하세요.

### 2단계 "층호수 형태로 변환"이 실패해요
→ **반드시 1단계에서 다운로드한 기본 엑셀 파일**을 업로드하세요.
→ 다른 엑셀 파일(직접 만든 파일 등)은 형식이 달라서 변환이 안 될 수 있습니다.

### 프로그램을 종료하고 싶어요
→ 터미널 창 2개를 모두 닫으면 됩니다. (또는 각 터미널에서 `Ctrl + C` 누르기)

### 내일 다시 사용하려면?
→ [3. 프로그램 실행하기](#3-프로그램-실행하기) 부터 다시 진행하면 됩니다. (1, 2단계는 최초 1회만)

### 명령줄로 직접 변환할 수 있나요? (고급)
→ 네! 다운로드 폴더에서 아래 명령어로 직접 변환 가능합니다:
```bash
cd C:\Users\사용자명\Downloads
python D:\이미지엑셀변환_프로젝트\excel_converter.py "파일명.xlsx"
```
→ 같은 폴더에 `파일명_변환.xlsx`이 생성됩니다.

---

## 프로그램 업데이트

새 버전이 있을 때 아래 명령어로 업데이트할 수 있습니다:
```bash
git pull origin main
npm install
pip install -r requirements.txt
```

---

> 문제가 발생하면 이 가이드를 다시 확인하거나, 담당자에게 문의하세요.
